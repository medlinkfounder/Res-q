<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>ResQ 112 - Profile</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet" />
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <style>
    body{font-family:'Inter',sans-serif;background:#0a0a1a;color:#e0e0e0;overflow-x:hidden}
    #globe-container{position:absolute;top:0;left:0;width:100%;height:100vh;z-index:1;filter:blur(3px)}
    #ripple-canvas{position:fixed;top:0;left:0;width:100%;height:100%;z-index:0}
    .content-overlay{position:relative;z-index:2;background:radial-gradient(circle,rgba(10,10,26,0.6),#0a0a1a 80%);backdrop-filter:blur(6px);min-height:100vh}
    .glass-card{background:rgba(255,255,255,0.05);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,0.1);padding:24px;border-radius:12px;transition:all .3s ease}
    .glass-card:hover{box-shadow:0 0 20px 6px rgba(0,255,255,0.5)}
  </style>
</head>
<body>
<canvas id="ripple-canvas"></canvas>
<div id="globe-container"></div>

<div class="content-overlay flex flex-col min-h-screen">
  <!-- Header -->
  <header class="p-4 bg-black/30 flex justify-between items-center">
    <div class="flex items-center gap-3">
      <img src="logo.png.png" alt="logo" class="h-10 w-10"/>
      <span class="font-bold text-xl">ResQ 112</span>
    </div>
    <select id="language-selector" class="bg-black/50 text-white px-2 py-1 rounded">
      <option value="en">English</option>
      <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
      <option value="as">‡¶Ö‡¶∏‡¶Æ‡ßÄ‡¶Ø‡¶º‡¶æ</option>
    </select>
  </header>

  <!-- Profile -->
  <main class="container mx-auto px-4 mt-12 flex flex-col md:flex-row gap-8 items-center">
    <!-- Left Side QR -->
    <div class="flex-1 flex justify-center">
      <img src="qr.png" alt="QR Code" class="w-64 h-64 rounded-lg shadow-lg"/>
    </div>

    <!-- Right Side Info -->
    <div class="flex-1 glass-card">
      <h2 class="text-2xl font-bold mb-4">üë§ User Profile</h2>
      <p><b>Name:</b> <span id="userName">‚Äî</span></p>
      <p><b>ID:</b> <span id="userId">‚Äî</span></p>
      <p><b>Method:</b> <span id="userMethod">‚Äî</span></p>
      <p><b>Blockchain ID:</b> <span id="blockchainId">‚Äî</span></p>
    </div>
  </main>
</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyBcLtaRPt6hTo4aEFRvcBwNq5-00soEjB4",
  authDomain: "sos-c1499.firebaseapp.com",
  databaseURL: "https://sos-c1499-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "sos-c1499",
  storageBucket: "sos-c1499.firebasestorage.app",
  messagingSenderId: "1008729495848",
  appId: "1:1008729495848:web:7d6c7d3a6047e2736e981d",
  measurementId: "G-JGBY3ZZPGC"
};
firebase.initializeApp(firebaseConfig);
const db=firebase.database();

const uid=localStorage.getItem("userId");
if(uid){
  db.ref("users/"+uid).once("value").then(snap=>{
    const data=snap.val();
    if(data){
      document.getElementById("userName").innerText=data.name||"‚Äî";
      document.getElementById("userId").innerText=data.id||"‚Äî";
      document.getElementById("userMethod").innerText=data.method||"‚Äî";
      // Blockchain ID (generate once)
      let bid=data.blockchainId;
      if(!bid){
        bid="BCID-"+Math.random().toString(36).substring(2,12).toUpperCase();
        db.ref("users/"+uid+"/blockchainId").set(bid);
      }
      document.getElementById("blockchainId").innerText=bid;
    }
  });
}

// Ripple background
const canvas=document.getElementById("ripple-canvas"),ctx=canvas.getContext("2d");
canvas.width=innerWidth;canvas.height=innerHeight;
let ripples=[];
class Ripple{constructor(x,y){this.x=x;this.y=y;this.radius=0;this.alpha=1;}
update(){this.radius+=1.5;this.alpha-=0.01;}
draw(){ctx.beginPath();ctx.arc(this.x,this.y,this.radius,0,2*Math.PI);ctx.strokeStyle=`rgba(0,255,255,${this.alpha})`;ctx.stroke();}}
function animateRipples(){ctx.clearRect(0,0,canvas.width,canvas.height);ripples.forEach((r,i)=>{r.update();r.draw();if(r.alpha<=0)ripples.splice(i,1);});requestAnimationFrame(animateRipples);}animateRipples();
addEventListener("mousemove",e=>ripples.push(new Ripple(e.clientX,e.clientY)));
addEventListener("resize",()=>{canvas.width=innerWidth;canvas.height=innerHeight;});

// Language (just sync storage)
const selector=document.getElementById("language-selector");
selector.value=localStorage.getItem("lang")||"en";
selector.addEventListener("change",()=>localStorage.setItem("lang",selector.value));
</script>
</body>
</html>
